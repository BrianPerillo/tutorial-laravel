<!DOCTYPE html>
<html lang="es-ES">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Bases de datos | Laravel</title>
    <meta name="description" content="Aprende a utilizar Laravel en tus proyectos web">
    
    
    <link rel="preload" href="/tutorial-laravel/assets/css/0.styles.be4b2af3.css" as="style"><link rel="preload" href="/tutorial-laravel/assets/js/app.88a4bd0b.js" as="script"><link rel="preload" href="/tutorial-laravel/assets/js/4.67e6017d.js" as="script"><link rel="prefetch" href="/tutorial-laravel/assets/js/2.aef8012b.js"><link rel="prefetch" href="/tutorial-laravel/assets/js/3.36beebcc.js"><link rel="prefetch" href="/tutorial-laravel/assets/js/5.6124fde0.js">
    <link rel="stylesheet" href="/tutorial-laravel/assets/css/0.styles.be4b2af3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/tutorial-laravel/" class="home-link router-link-active"><!----> <span class="site-name">Laravel</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tutorial-laravel/" class="nav-link">Guía</a></div><div class="nav-item"><a href="https://youtube.com/bluuweb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Youtube
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tutorial-laravel/" class="nav-link">Guía</a></div><div class="nav-item"><a href="https://youtube.com/bluuweb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Youtube
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/tutorial-laravel/" class="sidebar-link">Introducción a Laravel</a></li><li><a href="/tutorial-laravel/bases-datos/" class="active sidebar-link">Bases de datos</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tutorial-laravel/bases-datos/#configurar-conexion" class="sidebar-link">Configurar conexión</a></li><li class="sidebar-sub-header"><a href="/tutorial-laravel/bases-datos/#migraciones" class="sidebar-link">Migraciones</a></li><li class="sidebar-sub-header"><a href="/tutorial-laravel/bases-datos/#eloquent" class="sidebar-link">Eloquent</a></li><li class="sidebar-sub-header"><a href="/tutorial-laravel/bases-datos/#crear-modelo-y-migracion" class="sidebar-link">Crear modelo y migración</a></li><li class="sidebar-sub-header"><a href="/tutorial-laravel/bases-datos/#leer-datos" class="sidebar-link">Leer datos</a></li><li class="sidebar-sub-header"><a href="/tutorial-laravel/bases-datos/#leer-un-dato" class="sidebar-link">Leer un dato</a></li><li class="sidebar-sub-header"><a href="/tutorial-laravel/bases-datos/#agregar-datos" class="sidebar-link">Agregar datos</a></li><li class="sidebar-sub-header"><a href="/tutorial-laravel/bases-datos/#validaciones" class="sidebar-link">Validaciones</a></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="bases-de-datos"><a href="#bases-de-datos" aria-hidden="true" class="header-anchor">#</a> Bases de datos</h1> <p>El ORM de <strong>Eloquent</strong> incluido con Laravel proporciona una implementación de ActiveRecord simple y hermosa para trabajar con su base de datos. Cada tabla de base de datos tiene un &quot;Modelo&quot; correspondiente que se utiliza para interactuar con esa tabla. Los modelos le permiten consultar datos en sus tablas, así como insertar nuevos registros en la tabla.</p> <h2 id="configurar-conexion"><a href="#configurar-conexion" aria-hidden="true" class="header-anchor">#</a> Configurar conexión</h2> <p>Abra el archivo <code>.env</code> (directorio raiz) y modifique según su conexión, en este ejemplo se detalla configuración con <strong>XAMPP</strong> y bases de datos <strong>mysql</strong> (deben crearla manualmente a través de phpMyAdmin).</p> <div class="language- extra-class"><pre class="language-text"><code>DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=nombreBaseDeDatos
DB_USERNAME=root
DB_PASSWORD=
</code></pre></div><h2 id="migraciones"><a href="#migraciones" aria-hidden="true" class="header-anchor">#</a> Migraciones</h2> <p>Una vez establecida la configuración de conexión debemos realizar las migraciones, pero antes si estás trabajando con una versión inferior de <strong>Mysql v5.7.7</strong> se saltará el siguiente error:</p> <p>Puedes revisar la solución oficial dando <a href="https://laravel-news.com/laravel-5-4-key-too-long-error" target="_blank" rel="noopener noreferrer">clic aquí<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>[Illuminate\Database\QueryException]
SQLSTATE[42000]: Syntax error or access violation: 1071 Specified key was too long; max key length is 767 bytes (SQL: alter table users add unique users_email_unique(email))

[PDOException]
SQLSTATE[42000]: Syntax error or access violation: 1071 Specified key was too long; max key length is 767 bytes
</code></pre></div><p>Para evitar este error debemos configurar el archivo <code>AppServiceProvider.php</code> (app/Provides/AppServiceProvider.php)</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Schema</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">defaultStringLength</span><span class="token punctuation">(</span><span class="token number">191</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Una vez realizada la modificación utilizaremos el siguiente comando:</p> <div class="language- extra-class"><pre class="language-text"><code>php artisan migrate
</code></pre></div><p>Esto nos creará las tablas de restablecer contraseña y usuarios que viene por defecto con Laravel, pero nosotros crearemos nuestras propias migraciones, para eso utilizaremos <strong>Eloquent</strong>.</p> <h2 id="eloquent"><a href="#eloquent" aria-hidden="true" class="header-anchor">#</a> Eloquent</h2> <p>El ORM de Eloquent incluido con Laravel proporciona una implementación de ActiveRecord simple y hermosa para trabajar con su base de datos. Cada tabla de base de datos tiene un <strong>&quot;Modelo&quot;</strong> correspondiente que se utiliza para interactuar con esa tabla. Los modelos le permiten consultar datos en sus tablas, así como insertar nuevos registros en la tabla.</p> <h2 id="crear-modelo-y-migracion"><a href="#crear-modelo-y-migracion" aria-hidden="true" class="header-anchor">#</a> Crear modelo y migración</h2> <p>Para crear un modelo con su respectiva migración utilizamos el siguiente comando:</p> <div class="language- extra-class"><pre class="language-text"><code>php artisan make:model Nota -m
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">Muy importante:</p> <p>Colocar los nombres de los modelos en singular.</p></div> <p>En la migración agregaremos los campos nombre y descripción:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notas'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bigIncrements</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'nombre'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'descripcion'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Para terminar el proceso de creación de tablas utilizaremos nuevamente:</p> <div class="language- extra-class"><pre class="language-text"><code>php artisan migrate
</code></pre></div><p>El resultado será el siguiente:</p> <div class="language- extra-class"><pre class="language-text"><code>Migrating: 2019_05_31_203433_create_notas_table
Migrated:  2019_05_31_203433_create_notas_table
</code></pre></div><p>Agregaremos datos manuales ficticios para poder pintarlos en nuestro sitio web.</p> <h2 id="leer-datos"><a href="#leer-datos" aria-hidden="true" class="header-anchor">#</a> Leer datos</h2> <p>Anteriormente habíamos creado un controlador para nuestras rutas, este se llama <strong>PageController</strong>, es aquí donde realizarmos las llamadas a la base de datos, pero esto no funciona si no tenemos nuestro modelo relacionado, el cual hicimos en la sección anterior.</p> <p>Piense en cada modelo Eloquent como un potente generador de consultas que le permite consultar con fluidez la tabla de la base de datos asociada con el modelo. Por ejemplo:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token variable">$flights</span> <span class="token operator">=</span> App\<span class="token package">Flight</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$flights</span> <span class="token keyword">as</span> <span class="token variable">$flight</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$flight</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Y esto aplicado a nuestro proyecto quedaría así:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PagesController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">inicio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token variable">$notas</span> <span class="token operator">=</span> App\<span class="token package">Nota</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'welcome'</span><span class="token punctuation">,</span> <span class="token function">compact</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notas'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Estamos enviando a la vista welcome todas las notas que creamos en nuestra base de datos utilizando una simple línea: <code>App\Nota::all();</code>, ojo que debemos agregar fuera de nuestra clase <code>use App;</code></p> <p>En la vista podemos realizar un ciclo foreach para pintar nuestros datos:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>table<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>col<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>id<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>col<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Nombre<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>col<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Descripción<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>col<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Handle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
        @foreach ($notas as $item)
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ $item-&gt;id }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>{{ $item-&gt;nombre }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>{{ $item-&gt;descripcion }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>@mdo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        @endforeach
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="leer-un-dato"><a href="#leer-un-dato" aria-hidden="true" class="header-anchor">#</a> Leer un dato</h2> <p><a href="http://www.youtube.com/watch?feature=player_embedded&v=z7ecV0tL1Gg
" target="_blank"><img src="http://img.youtube.com/vi/z7ecV0tL1Gg/0.jpg" alt="Tutorrial bluuweb" width="240" height="180" border></a></p> <p>Para traer la información de un solo dato de nuestra base de datos, debemos realizar lo siguiente:</p> <ol><li>Agregar un boton o enlace para que el cliente seleccione el detalle de un solo campo:</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
    @foreach ($notas as $item)
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ $item-&gt;id }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{route('notas.detalle', $item)}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                {{ $item-&gt;nombre }}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>{{ $item-&gt;descripcion }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>@mdo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
    @endforeach
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li>Crear la ruta <code>notas.detalle</code> en <code>routes/web.php</code> con su respectivo controlador, recuerda que estamos pasando el id en forma de parámetro, por lo tanto nuestro controlador debería recibirlo:</li></ol> <div class="danger custom-block"><p class="custom-block-title">MODIFICACIÓN QUE NO VERÁS EN EL VIDEO</p> <p>Agregué la siguiente ruta: <code>/detalle/{id}</code> esto es para que no se destruya nuestras otras vistas, en el video #10 del curso se explica esta modificación, pero recomiendo utilizarla desde ya!</p></div> <div class="language-php extra-class"><pre class="language-php"><code>Route<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/detalle/{id}'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'PagesController@detalle'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notas.detalle'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>Crear función en controlador:</li></ol> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">detalle</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        
    <span class="token comment">// $nota = App\Nota::find($id);</span>

    <span class="token comment">//Aquí valida si existe sino redirije al 404</span>
    <span class="token variable">$nota</span> <span class="token operator">=</span> App\<span class="token package">Nota</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">findOrFail</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notas.detalle'</span><span class="token punctuation">,</span> <span class="token function">compact</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'nota'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="4"><li>Crear la vista detalle, en este ejemplo se creó en <code>views/notas/detalle.blade.php</code>:</li></ol> <div class="language-html extra-class"><pre class="language-html"><code>@section('seccion')
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Nota Detalle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span><span class="token punctuation">&gt;</span></span>Id: {{ $nota-&gt;id }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span><span class="token punctuation">&gt;</span></span>Nombre: {{ $nota-&gt;nombre }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span><span class="token punctuation">&gt;</span></span>Descripción: {{ $nota-&gt;descripcion }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">&gt;</span></span>
@endsection
</code></pre></div><h2 id="agregar-datos"><a href="#agregar-datos" aria-hidden="true" class="header-anchor">#</a> Agregar datos</h2> <p>Para agregar nuevos elementos debemos realizar los mismos procedimientos, agregar una vista, una ruta y un controlador.</p> <h4 id="vista"><a href="#vista" aria-hidden="true" class="header-anchor">#</a> Vista</h4> <p>Agregaremos el formulario para insertar nuevos datos:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{ route('notas.crear') }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    @csrf
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>nombre<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Nombre<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>form-control mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>descripcion<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Descripcion<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>form-control mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-primary btn-block<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Agregar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>No olives utilizar el atributo name en cada uno de tus input, este debe ser el mismo campo de su base de datos. Por otro lado configuramos el método POST y la acción debe llamar a una nueva ruta.</p> <p><strong>Protección CSRF:</strong> Laravel facilita la protección de su aplicación de los ataques de falsificación de solicitudes entre sitios (CSRF). Las falsificaciones de solicitudes entre sitios son un tipo de explotación maliciosa en la que se realizan comandos no autorizados en nombre de un usuario autenticado.</p> <p>Laravel genera automáticamente un &quot;token&quot; CSRF para cada sesión de usuario activa gestionada por la aplicación. Este token se usa para verificar que el usuario autenticado es el que realiza las solicitudes a la aplicación.</p> <p>Por lo tanto simplemente tenemos que agregar <code>@csrf</code> directiva Blade para generar el campo de token.</p> <p><a href="https://laravel.com/docs/5.8/csrf" target="_blank" rel="noopener noreferrer">Guía oficial de CSRF Laravel 5.8<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="rutas"><a href="#rutas" aria-hidden="true" class="header-anchor">#</a> Rutas</h4> <p>Aquí veremos un nuevo método en las rutas:</p> <div class="language-php extra-class"><pre class="language-php"><code>Route<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'PagesController@crear'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notas.crear'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="controlador"><a href="#controlador" aria-hidden="true" class="header-anchor">#</a> Controlador</h4> <p>Aquí realizaremos toda la acción para guardar en la base de datos, utilizando el modelo <code>Nota</code> y <code>Request $request</code>, este último lo pasamos como parámetro para recibir los datos de nuestro formulario. Con Eloquent solo llamamos a la función <code>save()</code> para almacenar en nuestra base de datos.</p> <div class="language-php extra-class"><pre class="language-php"><code>
<span class="token keyword">class</span> <span class="token class-name">PagesController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">crear</span><span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// return $request-&gt;all();</span>

        <span class="token variable">$notaNueva</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">App<span class="token punctuation">\</span>Nota</span><span class="token punctuation">;</span>
        <span class="token variable">$notaNueva</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">nombre</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">nombre</span><span class="token punctuation">;</span>
        <span class="token variable">$notaNueva</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">descripcion</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">descripcion</span><span class="token punctuation">;</span>

        <span class="token variable">$notaNueva</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mensaje'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Nota agregada'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Request $request</strong>: Para obtener una instancia de la solicitud HTTP actual a través de la inyección de dependencia, debe escribir la clase en el método de su controlador. La instancia de solicitud entrante será automáticamente inyectada por el contenedor de servicios: <code>Illuminate\Http\Request</code></p> <p><a href="https://laravel.com/docs/5.8/requests" target="_blank" rel="noopener noreferrer">Request documentación Laravel 5.8<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Una cosa interesante es utiliza <code>back()</code> para retroceder en la visa y <code>with()</code> para enviar un mensaje, este caso nota agregada que lo podríamos pintar con un alerta en nuestra vista:</p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">session</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mensaje'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token double-quoted-string string">&quot;alert alert-success&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">session</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mensaje'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
@<span class="token keyword">endif</span>
</code></pre></div><p><a href="https://laravel.com/docs/5.8/redirects#redirecting-with-flashed-session-data" target="_blank" rel="noopener noreferrer">Redireccionamiento con datos<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Si bien nuestra aplicación web guarda los datos nos falta un paso muy importante que son las validaciones.</p> <h2 id="validaciones"><a href="#validaciones" aria-hidden="true" class="header-anchor">#</a> Validaciones</h2></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/tutorial-laravel/" class="prev router-link-active">
          Introducción a Laravel
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/tutorial-laravel/assets/js/app.88a4bd0b.js" defer></script><script src="/tutorial-laravel/assets/js/4.67e6017d.js" defer></script>
  </body>
</html>
